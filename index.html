<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chat mit Gyro-Effekt (Dark Mode)</title>
  <style>
    :root {
      --accent: #00ffae;
      --secondary: #2b2b2b;
      --bg: #0e0e0e;
      --text: #f0f0f0;
    }

    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin: 0;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    .toggle-container {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      color: var(--text);
    }

    .chat {
      width: 100%;
      max-width: 600px;
    }

    .msg-rx,
    .msg-tx {
      display: flex;
      align-items: center;
      margin-block: .6rem;
    }

    .msg-rx {
      justify-content: flex-start;
    }

    .msg-tx {
      justify-content: flex-end;
    }

    .msg-content-rx,
    .msg-content-tx {
      padding-inline: 14px;
      padding-block: 8px;
      border-radius: 16px;
      max-width: 80vw;
      transition: box-shadow 0.2s ease, transform 0.2s ease;
    }

    .msg-content-rx {
      background-color: var(--secondary);
      color: var(--text);
      margin-left: 12px;
      box-shadow: 0 0 14px rgba(255, 255, 255, 0.05);
    }

    .msg-content-tx {
      background-color: var(--accent);
      color: #000;
      margin-right: 12px;
      box-shadow: 0 0 25px rgba(0, 255, 174, 0.4);
    }

    /* Toggle switch */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 26px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #555;
      transition: .4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--accent);
    }

    input:checked + .slider:before {
      transform: translateX(24px);
    }
  </style>
</head>
<body>

  <div class="toggle-container">
    <label class="switch">
      <input type="checkbox" id="gyroToggle">
      <span class="slider"></span>
    </label>
    <span>Gyro-Effekt aktivieren</span>
  </div>

  <div class="chat">
    <div class="msg-rx">
      <div class="msg-content-rx">Hi!</div>
    </div>
    <div class="msg-tx">
      <div class="msg-content-tx">Hey! Wie gehtâ€™s dir?</div>
    </div>
    <div class="msg-tx">
      <div class="msg-content-tx">Lorem ipsum dolor sit amet consectetur adipisicing elit. Doloremque fugit nulla corporis!</div>
    </div>
    <div class="msg-rx">
      <div class="msg-content-rx">Nice, gefÃ¤llt mir ðŸ˜„</div>
    </div>
  </div>

  <script>
    const toggle = document.getElementById('gyroToggle');
    const rxMessages = document.querySelectorAll('.msg-content-rx');
    const txMessages = document.querySelectorAll('.msg-content-tx');
    let gyroActive = false;

function handleOrientation(event) {
  if (!gyroActive) return;

  const beta = event.beta || 0;   // Neigung nach vorne/hinten (-180 bis 180)
  const gamma = event.gamma || 0; // Neigung seitlich (-90 bis 90)

  // --- Offset-Werte fÃ¼r natÃ¼rliche Handy-Halteposition ---
  const betaOffset = 40;  // typischer Winkel beim normalen Halten (leicht nach hinten geneigt)
  const gammaOffset = 0;  // bei Bedarf leichtes seitliches Offset

  // --- Angepasste Werte mit Offsets ---
  const betaAdjusted = beta - betaOffset;
  const gammaAdjusted = gamma - gammaOffset;

  // --- Skalierung (wie vorher) ---
  const xOffset = Math.max(-30, Math.min(30, gammaAdjusted * 1.2));
  const yOffset = Math.max(-30, Math.min(30, betaAdjusted * 2.5));

  rxMessages.forEach(msg => {
    msg.style.boxShadow = `${xOffset / 2}px ${yOffset / 2}px 25px rgba(255, 255, 255, 0.15)`;
    msg.style.transform = `translate(${xOffset / 10}px, ${yOffset / 10}px)`;
  });

  txMessages.forEach(msg => {
    msg.style.boxShadow = `${-xOffset / .5}px ${-yOffset / .5}px 40px rgba(0, 255, 174, 0.6)`;
    msg.style.transform = `translate(${xOffset / 15}px, ${-yOffset / 15}px)`;
  });
}


    toggle.addEventListener('change', async () => {
      gyroActive = toggle.checked;

      if (gyroActive && typeof DeviceOrientationEvent.requestPermission === 'function') {
        try {
          const permission = await DeviceOrientationEvent.requestPermission();
          if (permission !== 'granted') {
            alert('Bitte erlaube den Zugriff auf den Bewegungssensor.');
            toggle.checked = false;
            gyroActive = false;
            return;
          }
        } catch (err) {
          console.error(err);
          alert('Sensor konnte nicht aktiviert werden.');
          toggle.checked = false;
          gyroActive = false;
          return;
        }
      }

      if (gyroActive) {
        window.addEventListener('deviceorientation', handleOrientation);
      } else {
        window.removeEventListener('deviceorientation', handleOrientation);
        rxMessages.forEach(msg => {
          msg.style.boxShadow = "0 0 14px rgba(255,255,255,0.05)";
          msg.style.transform = "translate(0,0)";
        });
        txMessages.forEach(msg => {
          msg.style.boxShadow = "0 0 25px rgba(0,255,174,0.4)";
          msg.style.transform = "translate(0,0)";
        });
      }
    });
  </script>
</body>
</html>
